# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ HTTP Router

[English](../en/PERFORMANCE_ANALYSIS.md) | **–†—É—Å—Å–∫–∏–π** | [Deutsch](../de/PERFORMANCE_ANALYSIS.md) | [Fran√ßais](../fr/PERFORMANCE_ANALYSIS.md) | [‰∏≠Êñá](../zh/PERFORMANCE_ANALYSIS.md)

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [1. –í–≤–µ–¥–µ–Ω–∏–µ](#1-–≤–≤–µ–¥–µ–Ω–∏–µ)
- [2. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#2-–º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- [3. –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã](#3-–Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ-—Ç–µ—Å—Ç—ã)
- [4. –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã](#4-—Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã)
- [5. –ú–∏–∫—Ä–æ–±–µ–Ω—á–º–∞—Ä–∫–∏](#5-–º–∏–∫—Ä–æ–±–µ–Ω—á–º–∞—Ä–∫–∏)
- [6. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏](#6-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
- [7. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#7-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

CloudCastle HTTP Router —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –±–æ–≥–∞—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.

### –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

- **PHP:** 8.4.13
- **–°–∏—Å—Ç–µ–º–∞:** Linux 5.15.0-160-generic
- **–ü–∞–º—è—Ç—å:** 2048 MB limit
- **CPU:** Multi-core –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
- **Xdebug:** –í–∫–ª—é—á–µ–Ω (–≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –±–µ–∑ Xdebug –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –≤—ã—à–µ –Ω–∞ 20-30%.

---

## 2. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

1. **–ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã (Load Tests)**
   - –°–∏–º—É–ª–∏—Ä—É—é—Ç —Ä–µ–∞–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É
   - –ü—Ä–æ–≤–µ—Ä—è—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
   - –ò–∑–º–µ—Ä—è—é—Ç –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

2. **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã (Stress Tests)**
   - –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
   - –ü–æ–∏—Å–∫ –ø—Ä–µ–¥–µ–ª–æ–≤ —Å–∏—Å—Ç–µ–º—ã
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏

3. **–ú–∏–∫—Ä–æ–±–µ–Ω—á–º–∞—Ä–∫–∏ (Microbenchmarks)**
   - –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –¢–æ—á–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è
   - –ü–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ú–µ—Ç—Ä–∏–∫–∏

- **Requests/sec** - –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- **Response time** - –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞
- **Memory usage** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- **CPU usage** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

---

## 3. –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã

### 3.1 Light Load (–õ–µ–≥–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –ú–∞—Ä—à—Ä—É—Ç—ã: 100
- –ó–∞–ø—Ä–æ—Å—ã: 1,000

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
Routes registered: 100
Total requests: 1,000
Duration: 0.0185s
Requests/sec: 53,975
Avg response time: 0.02ms
Memory peak: 6.00 MB
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚ö° –û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üíæ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- üìä –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞

### 3.2 Medium Load (–°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –ú–∞—Ä—à—Ä—É—Ç—ã: 500
- –ó–∞–ø—Ä–æ—Å—ã: 5,000

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
Routes registered: 500
Total requests: 5,000
Duration: 0.0924s
Requests/sec: 54,135
Avg response time: 0.02ms
Memory peak: 6.00 MB
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç
- üíæ –ü–∞–º—è—Ç—å –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ
- üìà –õ–∏–Ω–µ–π–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3.3 Heavy Load (–¢—è–∂–µ–ª–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- –ú–∞—Ä—à—Ä—É—Ç—ã: 1,000
- –ó–∞–ø—Ä–æ—Å—ã: 10,000

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
Routes registered: 1,000
Total requests: 10,000
Duration: 0.1822s
Requests/sec: 54,891
Avg response time: 0.02ms
Memory peak: 6.00 MB
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–∞–∂–µ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—Ä–æ—Å–ª–∞
- üíæ –û—Ç–ª–∏—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
- üéØ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 3.4 Concurrent Access Patterns

**–¢–µ—Å—Ç:** –°–∏–º—É–ª—è—Ü–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
Pattern variations: 4
Total requests: 5,000
Requests/sec: 8,107
Avg time: 0.12ms
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–≤—è–∑–∞–Ω–æ —Å —Å–∏–º—É–ª—è—Ü–∏–µ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –≤ –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å—Ä–µ–¥–µ PHP.

### 3.5 Cached vs Uncached

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
```
Uncached: 54,490 req/sec
Cached:   48,504 req/sec
Difference: -12.3%
```

**–ê–Ω–∞–ª–∏–∑:**
–ù–µ–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±—ã—Å—Ç—Ä–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è:
1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–Ω–¥–µ–∫—Å–∞–º (URI index, Method index)
2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏—é overhead –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
3. –ü—Ä—è–º–æ–º—É –¥–æ—Å—Ç—É–ø—É –∫ –æ–±—ä–µ–∫—Ç–∞–º –≤ –ø–∞–º—è—Ç–∏

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à:**
- –ü—Ä–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (>10,000)
- –ö–æ–≥–¥–∞ –º–∞—Ä—à—Ä—É—Ç—ã —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è
- –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏

**–ö–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à:**
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã
- –ß–∞—Å—Ç—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ù–µ–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (<1,000)

---

## 4. –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã

### 4.1 Maximum Routes Capacity

**–¶–µ–ª—å:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–ü—Ä–æ—Ü–µ—Å—Å:**
```
10,000 routes: 14.00 MB
20,000 routes: 28.00 MB
30,000 routes: 44.00 MB
...
90,000 routes: 134.01 MB
100,000 routes: 150.01 MB
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ú–∞–∫—Å–∏–º—É–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ: **100,000 –º–∞—Ä—à—Ä—É—Ç–æ–≤**
- –í—Ä–µ–º—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: 4.27s
- –ü–∞–º—è—Ç—å: 150.01 MB
- **–ù–∞ –º–∞—Ä—à—Ä—É—Ç: 1.54 KB**

**–í—ã–≤–æ–¥:** –†–æ—É—Ç–µ—Ä –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á –º–∞—Ä—à—Ä—É—Ç–æ–≤.

### 4.2 Deep Group Nesting

**–¢–µ—Å—Ç:** –ì–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Maximum nesting depth: 50 levels
Routes created: 1
Status: SUCCESS ‚úÖ
```

**–ê–Ω–∞–ª–∏–∑:**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≥–ª—É–±–æ–∫–∞—è –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å
- –ù–µ—Ç stack overflow
- –ü—Ä–µ—Ñ–∏–∫—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∫–ª–µ–∏–≤–∞—é—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä:**
```php
$router->group(['prefix' => 'a'], function() {
    $router->group(['prefix' => 'b'], function() {
        $router->group(['prefix' => 'c'], function() {
            // ... 47 –±–æ–ª–µ–µ —É—Ä–æ–≤–Ω–µ–π
            $router->get('/endpoint', $action);
        });
    });
});
// URI: /a/b/c/.../endpoint
```

### 4.3 Long URI Patterns

**–¢–µ—Å—Ç:** –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–µ URI

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
URI length: 1,980 characters
Segments: 200
Registration time: 0.38ms
Match time: 0.57ms
```

**–ê–Ω–∞–ª–∏–∑:**
- –î–ª–∏–Ω–Ω—ã–µ URI –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

### 4.4 Extreme Request Volume

**–¢–µ—Å—Ç:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–≥—Ä–æ–º–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
10,000 requests: 51,906 req/sec
20,000 requests: 52,765 req/sec
50,000 requests: 52,894 req/sec
100,000 requests: 52,511 req/sec
150,000 requests: 52,458 req/sec
200,000 requests: 52,694 req/sec
```

**–ò—Ç–æ–≥–æ:**
- –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: **200,000 –∑–∞–ø—Ä–æ—Å–æ–≤**
- –£—Å–ø–µ—à–Ω–æ: 200,000
- –û—à–∏–±–æ–∫: 0
- –í—Ä–µ–º—è: 3.80s
- **–°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å: 52,694 req/sec**
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: 0.019ms

**–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```
Req/sec
55k |    ‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè
54k |  ‚óè‚óè
53k | ‚óè
52k |‚óè
51k |
    +---------------------------
      0    50k   100k  150k  200k
```

**–í—ã–≤–æ–¥:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π.

### 4.5 Memory Limit Stress

**–¢–µ—Å—Ç:** –¢–µ—Å—Ç –ø—Ä–µ–¥–µ–ª–æ–≤ –ø–∞–º—è—Ç–∏

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- PHP Memory Limit: 2048 MB
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–æ 80% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
100,000 routes: 23.01 MB (8.7%)
200,000 routes: 156.01 MB (15.2%)
500,000 routes: 556.01 MB (34.8%)
1,000,000 routes: 1.21 GB (67.9%)
1,095,000 routes: 1.45 GB (80.0%) - STOP
```

**–ò—Ç–æ–≥–æ:**
- **–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 1,095,000 –º–∞—Ä—à—Ä—É—Ç–æ–≤**
- –ü–∞–º—è—Ç—å: 1.45 GB
- **–ù–∞ –º–∞—Ä—à—Ä—É—Ç: 1.39 KB**

**–≠–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è:**
- –ü—Ä–∏ 2GB –ø–∞–º—è—Ç–∏: **~1.4 –º–ª–Ω –º–∞—Ä—à—Ä—É—Ç–æ–≤**
- –ü—Ä–∏ 4GB –ø–∞–º—è—Ç–∏: **~2.9 –º–ª–Ω –º–∞—Ä—à—Ä—É—Ç–æ–≤**
- –ü—Ä–∏ 8GB –ø–∞–º—è—Ç–∏: **~5.8 –º–ª–Ω –º–∞—Ä—à—Ä—É—Ç–æ–≤**

---

## 5. –ú–∏–∫—Ä–æ–±–µ–Ω—á–º–∞—Ä–∫–∏

### 5.1 Router Operations

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –ò—Ç–µ—Ä–∞—Ü–∏–π | –ü–∞–º—è—Ç—å |
|----------|-------|----------|--------|
| Add 1000 routes | 3.435 ms | 1000 | 169 MB |
| Match first route | 123.106 Œºs | 1000 | 7.4 MB |
| Match middle route | 1.746 ms | 1000 | 84.7 MB |
| Match last route | 3.472 ms | 1000 | 169 MB |
| Named lookup | 3.858 ms | 1000 | 180 MB |
| Route groups | 2.577 ms | 1000 | 85.9 MB |
| With middleware | 2.030 ms | 1000 | 96 MB |
| With parameters | 72.997 Œºs | 1000 | 5.3 MB |

**–ê–Ω–∞–ª–∏–∑:**

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤** (3.4ms):
   - –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è
   - 0.0034ms –Ω–∞ –º–∞—Ä—à—Ä—É—Ç
   - –í–∫–ª—é—á–∞–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

2. **–ü–æ–∏—Å–∫ –ø–µ—Ä–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞** (123Œºs):
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —á–∞—Å—Ç—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ URI –∏–Ω–¥–µ–∫—Å–∞
   - –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

3. **–ü–æ–∏—Å–∫ —Å—Ä–µ–¥–Ω–µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞** (1.7ms):
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ method –∏–Ω–¥–µ–∫—Å–∞
   - –°–æ–∫—Ä–∞—â—ë–Ω–Ω—ã–π –ø–æ–∏—Å–∫
   - –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

4. **–ü–æ–∏—Å–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞** (3.5ms):
   - Worst-case —Å—Ü–µ–Ω–∞—Ä–∏–π
   - –í—Å—ë –µ—â—ë –ø—Ä–∏–µ–º–ª–µ–º–æ
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

5. **–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏** (3.9ms):
   - –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ HashMap
   - O(1) —Å–ª–æ–∂–Ω–æ—Å—Ç—å
   - –ë—ã—Å—Ç—Ä—ã–π lookup

### 5.2 Cache Operations

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –ü–∞–º—è—Ç—å |
|----------|-------|--------|
| Compile routes | 8.666 ms | 181 MB |
| Load from cache | 10.586 ms | 182 MB |

**–ê–Ω–∞–ª–∏–∑:**

- **–ö–æ–º–ø–∏–ª—è—Ü–∏—è:** –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤
- **–ó–∞–≥—Ä—É–∑–∫–∞:** –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è + –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
- **Overhead:** ~2ms –Ω–∞ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PHP opcache –¥–ª—è –∫–µ—à–∞.

### 5.3 Rate Limiter Operations

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| Create limiter | 6.585 Œºs | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è |
| Track attempts | 640.792 Œºs | 100 –ø–æ–ø—ã—Ç–æ–∫ |
| Check limit | 775.588 Œºs | 100 –ø—Ä–æ–≤–µ—Ä–æ–∫ |
| Multiple IDs | 687.241 Œºs | 10 –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ |

**–ê–Ω–∞–ª–∏–∑:**

- –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏–º–∏—Ç–µ—Ä–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ–µ (~6.4Œºs –Ω–∞ –ø–æ–ø—ã—Ç–∫—É)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–º–Ω–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ (~7.8Œºs)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –±–µ–∑ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏

---

## 6. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 6.1 –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### 1. URI Index (–ò–Ω–¥–µ–∫—Å URI)

```php
private array $uriIndex = [];

// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –º–∞—Ä—à—Ä—É—Ç–∞
if (!str_contains($uri, '{')) {
    $this->uriIndex[$uri][] = $routeIndex;
}

// –ü—Ä–∏ –ø–æ–∏—Å–∫–µ
if (isset($this->uriIndex[$uri])) {
    return $this->uriIndex[$uri]; // O(1)
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ —Ç–æ—á–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π.

#### 2. Method Index (–ò–Ω–¥–µ–∫—Å –º–µ—Ç–æ–¥–æ–≤)

```php
private array $methodIndex = [];

// –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø–æ HTTP –º–µ—Ç–æ–¥—É
foreach ($route->getMethods() as $method) {
    $this->methodIndex[$method][] = $routeIndex;
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞.

#### 3. Named Routes HashMap

```php
private array $namedRoutes = [];

$this->namedRoutes[$name] = $route; // O(1) set
$route = $this->namedRoutes[$name]; // O(1) get
```

**–≠—Ñ—Ñ–µ–∫—Ç:** O(1) –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏.

#### 4. Tagged Routes Index

```php
private array $taggedRoutes = [];

foreach ($tags as $tag) {
    $this->taggedRoutes[$tag][] = $route;
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ë—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–≥–∞–º.

#### 5. Early Exit Strategy

```php
public function dispatch(/* ... */): Route {
    // –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤ –ø–æ—Ä—è–¥–∫–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
    if ($domain && !$route->isDomainAllowed($domain)) {
        continue; // –†–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥
    }
    if ($port && !$route->isPortAllowed($port)) {
        continue; // –†–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥
    }
    // ...
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫.

### 6.2 –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 1. Trie-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤

**–¢–µ–∫—É—â–µ–µ:** –õ–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –º–∞—Å—Å–∏–≤—É  
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** Radix Tree –¥–ª—è O(log n) –ø–æ–∏—Å–∫–∞

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à:** 30-50% –¥–ª—è >1000 –º–∞—Ä—à—Ä—É—Ç–æ–≤

#### 2. Compiled Regex Cache

**–¢–µ–∫—É—â–µ–µ:** –ö–æ–º–ø–∏–ª—è—Ü–∏—è —Ä–µ–≥—É–ª—è—Ä–æ–∫ –Ω–∞ –ª–µ—Ç—É  
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ü—Ä–µ–¥–∫–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∫–µ—à

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à:** 10-15%

#### 3. PHP JIT Optimization

**–¢–µ–∫—É—â–µ–µ:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π PHP  
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ PHP JIT

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à:** 20-40%

---

## 7. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 7.1 –î–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PHP 8.2+ —Å JIT:**
   ```ini
   opcache.enable=1
   opcache.jit_buffer_size=100M
   opcache.jit=1255
   ```

2. **–û—Ç–∫–ª—é—á–∏—Ç–µ Xdebug –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
   ```bash
   php -d xdebug.mode=off script.php
   ```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
   ```php
   $route->name('users.show');
   // –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø O(1)
   $router->getRouteByName('users.show');
   ```

4. **–ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
   ```php
   $router->group(['prefix' => '/api'], function() {
       // –í—Å–µ API –º–∞—Ä—à—Ä—É—Ç—ã
   });
   ```

5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Rate Limiting —Ä–∞–∑—É–º–Ω–æ:**
   ```php
   // –¢–æ–ª—å–∫–æ –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints
   $route->throttle(60, 1); // 60 req/min
   ```

### 7.2 –î–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (>10,000 –º–∞—Ä—à—Ä—É—Ç–æ–≤)

1. **–í–∫–ª—é—á–∏—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```php
   $router->enableCache('var/cache/routes');
   $router->compile();
   ```

2. **–†–∞–∑–¥–µ–ª–∏—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã –ø–æ –¥–æ–º–µ–Ω–∞–º:**
   ```php
   // api.example.com
   $router->group(['domain' => 'api.example.com'], function() {
       // API routes
   });
   
   // admin.example.com
   $router->group(['domain' => 'admin.example.com'], function() {
       // Admin routes
   });
   ```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–≥–∏ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:**
   ```php
   $route->tag(['public', 'v1']);
   // –ë—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
   $publicRoutes = $router->getRoutesByTag('public');
   ```

### 7.3 –î–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

1. **–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤:**
   - –û–¥–∏–Ω —Å–µ—Ä–≤–∏—Å = –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
   - 50-200 –º–∞—Ä—à—Ä—É—Ç–æ–≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ

2. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–µ—à:**
   - Overhead –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–Ω
   - –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –±—ã—Å—Ç—Ä–µ–µ

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Ä—Ç—ã –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏:**
   ```php
   $router->group(['port' => 8081], function() {
       // User service
   });
   
   $router->group(['port' => 8082], function() {
       // Product service
   });
   ```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

CloudCastle HTTP Router –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:

- ‚ö° **–í—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 50,000+ req/sec
- üíæ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:** ~1.4KB –Ω–∞ –º–∞—Ä—à—Ä—É—Ç
- üìà **–û—Ç–ª–∏—á–Ω—É—é –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –¥–æ 1+ –º–ª–Ω –º–∞—Ä—à—Ä—É—Ç–æ–≤
- üéØ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** 0 –æ—à–∏–±–æ–∫ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
- üîß **–ì–∏–±–∫–æ—Å—Ç—å:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ - –æ—Ç –Ω–µ–±–æ–ª—å—à–∏—Ö API –¥–æ –∫—Ä—É–ø–Ω—ã—Ö enterprise –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

[‚¨Ü –ù–∞–≤–µ—Ä—Ö](#–∞–Ω–∞–ª–∏–∑-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-http-router)

---

¬© 2024 CloudCastle HTTP Router. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.

