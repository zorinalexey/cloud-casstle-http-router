# Rate Limiting - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

[English](../../en/features/RATE_LIMITING_FEATURES.md) | **–†—É—Å—Å–∫–∏–π** | [Deutsch](../../de/features/RATE_LIMITING_FEATURES.md) | [Fran√ßais](../../fr/features/RATE_LIMITING_FEATURES.md) | [‰∏≠Êñá](../../zh/features/RATE_LIMITING_FEATURES.md)

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
- [–ë–∞–∑–æ–≤—ã–π throttle](#–±–∞–∑–æ–≤—ã–π-throttle)
- [TimeUnit enum](#timeunit-enum)
- [–£–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏](#—É–¥–æ–±–Ω—ã–µ-–º–µ—Ç–æ–¥—ã-–ø–æ-–≤—Ä–µ–º–µ–Ω–∏)
- [throttleWithBan - –∞–≤—Ç–æ–±–∞–Ω](#throttlewithban---–∞–≤—Ç–æ–±–∞–Ω)
- [–ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª—é—á–∏](#–∫–∞—Å—Ç–æ–º–Ω—ã–µ-–∫–ª—é—á–∏)
- [RateLimiter –∫–ª–∞—Å—Å](#ratelimiter-–∫–ª–∞—Å—Å)
- [Route Shortcuts](#route-shortcuts)
- [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏](#—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-—Å-–∞–Ω–∞–ª–æ–≥–∞–º–∏)
- [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

Rate Limiting (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤) - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã API –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –æ—Ç:
- DDoS –∞—Ç–∞–∫
- –ë—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫
- –°–ø–∞–º–∞
- –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏

CloudCastle HTTP Router –≤–∫–ª—é—á–∞–µ—Ç **–º–æ—â–Ω—É—é –∏ –≥–∏–±–∫—É—é —Å–∏—Å—Ç–µ–º—É Rate Limiting** –∏–∑ –∫–æ—Ä–æ–±–∫–∏.

---

## –ë–∞–∑–æ–≤—ã–π throttle

### –û–ø–∏—Å–∞–Ω–∏–µ

–ú–µ—Ç–æ–¥ `throttle()` –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–∞—Ä—à—Ä—É—Ç—É –≤ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```php
use CloudCastle\Http\Router\Facade\Route;

// 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
Route::get('/api/data', $action)
    ->throttle(60, 1);

// 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å
Route::post('/api/submit', $action)
    ->throttle(100, 60);

// 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å
Route::post('/api/export', $action)
    ->throttle(10, 1440);
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

```php
throttle(
    int $maxAttempts,     // –ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫
    int $decayMinutes,    // –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ –≤ –º–∏–Ω—É—Ç–∞—Ö
    ?callable $key = null // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–ª—é—á –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
)
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏

| –†–æ—É—Ç–µ—Ä | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Rate Limiting | API | –ì–∏–±–∫–æ—Å—Ç—å | –û—Ü–µ–Ω–∫–∞ |
|--------|--------------------------|-----|----------|--------|
| **CloudCastle** | ‚úÖ **–î–∞** | **->throttle()** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** |
| Laravel | ‚úÖ –î–∞ | ->middleware('throttle:60,1') | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| Symfony | ‚ùå –ù–µ—Ç | –¢—Ä–µ–±—É–µ—Ç RateLimiter component | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| FastRoute | ‚ùå –ù–µ—Ç | –ù—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å —Å–≤–æ–π | ‚≠ê | ‚≠ê |
| Slim | ‚ùå –ù–µ—Ç | –¢—Ä–µ–±—É–µ—Ç middleware –ø–∞–∫–µ—Ç | ‚≠ê‚≠ê | ‚≠ê‚≠ê |

**–ü–ª—é—Å—ã CloudCastle:**
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–æ –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π API (–æ–¥–∏–Ω –º–µ—Ç–æ–¥)
- ‚úÖ Fluent interface
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏ (–Ω–µ Redis –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**API endpoint:**
```php
// –ü—É–±–ª–∏—á–Ω—ã–π API
Route::get('/api/public/data', $action)
    ->throttle(100, 1); // 100 req/min

// –ü—Ä–∏–≤–∞—Ç–Ω—ã–π API
Route::get('/api/private/data', $action)
    ->middleware(['auth'])
    ->throttle(1000, 1); // 1000 req/min –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
```

**–§–æ—Ä–º—ã:**
```php
// –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
Route::post('/contact', $action)
    ->throttle(5, 60); // 5 –æ—Ç–ø—Ä–∞–≤–æ–∫ –≤ —á–∞—Å

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
Route::post('/register', $action)
    ->throttle(3, 600); // 3 —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ 10 –º–∏–Ω—É—Ç
```

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
```php
// –ü–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
Route::post('/login', $action)
    ->throttle(5, 1); // 5 –ø–æ–ø—ã—Ç–æ–∫ –≤ –º–∏–Ω—É—Ç—É
```

---

## TimeUnit enum

### –û–ø–∏—Å–∞–Ω–∏–µ

TimeUnit - —ç—Ç–æ enum –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞ –º–∏–Ω—É—Ç.

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã

```php
use CloudCastle\Http\Router\TimeUnit;

TimeUnit::SECOND  // 1 —Å–µ–∫—É–Ω–¥–∞
TimeUnit::MINUTE  // 60 —Å–µ–∫—É–Ω–¥
TimeUnit::HOUR    // 3600 —Å–µ–∫—É–Ω–¥
TimeUnit::DAY     // 86400 —Å–µ–∫—É–Ω–¥
TimeUnit::WEEK    // 604800 —Å–µ–∫—É–Ω–¥
TimeUnit::MONTH   // 2592000 —Å–µ–∫—É–Ω–¥ (30 –¥–Ω–µ–π)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```php
// 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å
Route::post('/api/report', $action)
    ->throttle(100, TimeUnit::DAY->value / 60); // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –º–∏–Ω—É—Ç—ã

// –ò–ª–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
$limiter = new RateLimiter(10, TimeUnit::HOUR->value);
```

### –ú–µ—Ç–æ–¥—ã TimeUnit

```php
$unit = TimeUnit::HOUR;

$seconds = $unit->toSeconds(2);  // 7200 (2 —á–∞—Å–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
$name = $unit->getName();        // 'hour'
$plural = $unit->getPlural();    // 'hours'
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏

| –†–æ—É—Ç–µ—Ä | TimeUnit enum | –£–¥–æ–±—Å—Ç–≤–æ | –û—Ü–µ–Ω–∫–∞ |
|--------|---------------|----------|--------|
| **CloudCastle** | ‚úÖ **–î–∞ (6 –µ–¥–∏–Ω–∏—Ü)** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** |
| Laravel | ‚ùå –ù–µ—Ç | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |
| Symfony | ‚ùå –ù–µ—Ç | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| FastRoute | ‚ùå –ù–µ—Ç | - | - |
| Slim | ‚ùå –ù–µ—Ç | - | - |

**–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** CloudCastle - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–æ—É—Ç–µ—Ä —Å TimeUnit enum!

**–ü–ª—é—Å—ã:**
- ‚úÖ –ß–∏—Ç–∞–µ–º—ã–π –∫–æ–¥
- ‚úÖ –ù–µ—Ç magic numbers
- ‚úÖ Type-safe
- ‚úÖ –°–∞–º–æ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º—ã–π

**–ü—Ä–∏–º–µ—Ä—ã:**
```php
// –Ø—Å–Ω–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ
Route::post('/export', $action)
    ->throttle(5, TimeUnit::DAY->value / 60);

// –í–º–µ—Å—Ç–æ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —á–∏—Å–µ–ª
// ->throttle(5, 1440) // –ß—Ç–æ —ç—Ç–æ –∑–∞ 1440?
```

---

## –£–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### perSecond()

–õ–∏–º–∏—Ç –Ω–∞ —Å–µ–∫—É–Ω–¥—É:

```php
// 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
Route::post('/api/track', $action)->perSecond(10);

// 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã
Route::post('/api/upload', $action)->perSecond(5, 3);
```

### perMinute()

–õ–∏–º–∏—Ç –Ω–∞ –º–∏–Ω—É—Ç—É:

```php
// 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
Route::get('/api/data', $action)->perMinute(60);

// 20 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 5 –º–∏–Ω—É—Ç
Route::post('/api/search', $action)->perMinute(20, 5);
```

### perHour()

–õ–∏–º–∏—Ç –Ω–∞ —á–∞—Å:

```php
// 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å
Route::get('/api/export', $action)->perHour(1000);

// 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 6 —á–∞—Å–æ–≤
Route::post('/api/batch', $action)->perHour(500, 6);
```

### perDay()

–õ–∏–º–∏—Ç –Ω–∞ –¥–µ–Ω—å:

```php
// 10000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å
Route::get('/api/reports', $action)->perDay(10000);

// 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ 7 –¥–Ω–µ–π
Route::post('/api/heavy', $action)->perDay(1000, 7);
```

### perWeek()

```php
// 50000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –Ω–µ–¥–µ–ª—é
Route::get('/api/analytics', $action)->perWeek(50000);
```

### perMonth()

```php
// 1000000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–µ—Å—è—Ü
Route::get('/api/stats', $action)->perMonth(1000000);
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –ú–µ—Ç–æ–¥ | CloudCastle | Laravel | Symfony |
|-------|-------------|---------|---------|
| perSecond() | ‚úÖ | ‚ùå | ‚ùå |
| perMinute() | ‚úÖ | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | ‚ùå |
| perHour() | ‚úÖ | ‚ùå | ‚ùå |
| perDay() | ‚úÖ | ‚ùå | ‚ùå |
| perWeek() | ‚úÖ | ‚ùå | ‚ùå |
| perMonth() | ‚úÖ | ‚ùå | ‚ùå |

**CloudCastle - –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º time-based –º–µ—Ç–æ–¥–æ–≤!**

---

## throttleWithBan - –∞–≤—Ç–æ–±–∞–Ω

### –û–ø–∏—Å–∞–Ω–∏–µ

**–£–ù–ò–ö–ê–õ–¨–ù–ê–Ø –í–û–ó–ú–û–ñ–ù–û–°–¢–¨!** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–Ω IP –ø–æ—Å–ª–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π –ª–∏–º–∏—Ç–∞.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```php
Route::post('/login', $action)
    ->throttleWithBan(
        maxAttempts: 5,           // 5 –ø–æ–ø—ã—Ç–æ–∫
        decaySeconds: 60,         // –∑–∞ 60 —Å–µ–∫—É–Ω–¥
        maxViolations: 3,         // –ø–æ—Å–ª–µ 3 –Ω–∞—Ä—É—à–µ–Ω–∏–π
        banDurationSeconds: 3600  // –±–∞–Ω –Ω–∞ 1 —á–∞—Å
    );

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
// 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç 6 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –º–∏–Ω—É—Ç—É ‚Üí –Ω–∞—Ä—É—à–µ–Ω–∏–µ #1
// 2. –ß–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É –¥–µ–ª–∞–µ—Ç –µ—â–µ 6 ‚Üí –Ω–∞—Ä—É—à–µ–Ω–∏–µ #2
// 3. –ï—â–µ —Ä–∞–∑ 6 –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –Ω–∞—Ä—É—à–µ–Ω–∏–µ #3
// 4. IP –ó–ê–ë–ê–ù–ï–ù –Ω–∞ 1 —á–∞—Å!
```

### –ü—Ä–∏–º–µ—Ä—ã

**–ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞:**
```php
Route::post('/api/auth', LoginController::class)
    ->throttleWithBan(
        maxAttempts: 10,
        decaySeconds: 60,
        maxViolations: 5,
        banDurationSeconds: 86400 // 24 —á–∞—Å–∞
    );
```

**–ó–∞—â–∏—Ç–∞ —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
```php
Route::post('/register', $action)
    ->throttleWithBan(
        maxAttempts: 3,
        decaySeconds: 300,  // 5 –º–∏–Ω—É—Ç
        maxViolations: 2,
        banDurationSeconds: 1800  // 30 –º–∏–Ω—É—Ç
    );
```

**API –∑–∞—â–∏—Ç–∞:**
```php
Route::post('/api/sensitive', $action)
    ->throttleWithBan(
        maxAttempts: 20,
        decaySeconds: 60,
        maxViolations: 10,
        banDurationSeconds: 3600
    );
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –†–æ—É—Ç–µ—Ä | throttleWithBan | –û—Ü–µ–Ω–∫–∞ |
|--------|-----------------|--------|
| **CloudCastle** | ‚úÖ **–í—Å—Ç—Ä–æ–µ–Ω–æ!** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** |
| Laravel | ‚ùå –¢—Ä–µ–±—É–µ—Ç –ø–∞–∫–µ—Ç | ‚≠ê‚≠ê |
| Symfony | ‚ùå –¢—Ä–µ–±—É–µ—Ç –ø–∞–∫–µ—Ç | ‚≠ê‚≠ê |
| FastRoute | ‚ùå | ‚≠ê |
| Slim | ‚ùå | ‚≠ê |

**–£–ù–ò–ö–ê–õ–¨–ù–û–°–¢–¨:** –¢–æ–ª—å–∫–æ CloudCastle –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π throttleWithBan!

---

## –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª—é—á–∏

### –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Rate Limiting –∏—Å–ø–æ–ª—å–∑—É–µ—Ç IP –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞. –ù–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–ª—é—á –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```php
// –ü–æ IP (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
Route::get('/api/data', $action)
    ->throttle(60, 1);

// –ü–æ User ID
Route::get('/api/data', $action)
    ->throttle(60, 1, function($request) {
        return $request->user()->id;
    });

// –ü–æ API –∫–ª—é—á—É
Route::get('/api/data', $action)
    ->throttle(1000, 1, function($request) {
        return $request->header('X-API-Key');
    });

// –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á
Route::post('/api/action', $action)
    ->throttle(10, 1, function($request) {
        return $request->user()->id . ':' . $request->ip();
    });
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –†–æ—É—Ç–µ—Ä | –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª—é—á–∏ | –ü—Ä–∏–º–µ—Ä—ã | –û—Ü–µ–Ω–∫–∞ |
|--------|-----------------|---------|--------|
| **CloudCastle** | ‚úÖ **–î–∞ (Closure)** | **User ID, API Key** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** |
| Laravel | ‚úÖ –î–∞ | User ID, API Key | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| Symfony | ‚ö†Ô∏è –°–ª–æ–∂–Ω–æ | –¢—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é | ‚≠ê‚≠ê‚≠ê |
| FastRoute | ‚ùå –ù–µ—Ç | - | - |
| Slim | ‚ùå –ù–µ—Ç | - | - |

**–ü–ª—é—Å—ã CloudCastle:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π API (Closure)
- ‚úÖ –õ—é–±–∞—è –ª–æ–≥–∏–∫–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å

**–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

**1. –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤:**
```php
Route::get('/api/premium', $action)
    ->throttle(1000, 1, function($request) {
        $user = $request->user();
        return $user->isPremium() 
            ? "premium:{$user->id}" 
            : "free:{$user->id}";
    });

// –í middleware –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–ª—é—á –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ä–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã
```

**2. –ü–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (multi-tenant):**
```php
Route::get('/api/data', $action)
    ->throttle(100, 1, function($request) {
        return $request->user()->organization_id;
    });
```

**3. –ü–æ endpoint:**
```php
Route::group(['prefix' => '/api'], function() {
    Route::get('/search', $action)
        ->throttle(30, 1, fn($req) => 'search:' . $req->ip());
    
    Route::get('/export', $action)
        ->throttle(5, 1, fn($req) => 'export:' . $req->ip());
});
```

---

## RateLimiter –∫–ª–∞—Å—Å

### –û–ø–∏—Å–∞–Ω–∏–µ

RateLimiter - —ç—Ç–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞–º–∏.

### –°–æ–∑–¥–∞–Ω–∏–µ

```php
use CloudCastle\Http\Router\RateLimiter;

// 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 1 –º–∏–Ω—É—Ç—É
$limiter = new RateLimiter(60, 1);

// 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å
$limiter = new RateLimiter(100, 60);
```

### –ú–µ—Ç–æ–¥—ã

#### attempt()

–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ø—ã—Ç–∫–∏:

```php
$limiter->attempt($identifier);
```

#### tooManyAttempts()

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞:

```php
if ($limiter->tooManyAttempts($identifier)) {
    throw new TooManyRequestsException();
}
```

#### remaining()

–û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–æ–ø—ã—Ç–∫–∏:

```php
$remaining = $limiter->remaining($identifier);
// 45 (–∏–∑ 60)
```

#### availableIn()

–ö–æ–≥–¥–∞ —Å–Ω–æ–≤–∞ –¥–æ—Å—Ç—É–ø–Ω–æ:

```php
$seconds = $limiter->availableIn($identifier);
// 42 (—Å–µ–∫—É–Ω–¥ –¥–æ —Å–±—Ä–æ—Å–∞)
```

### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä

```php
use CloudCastle\Http\Router\RateLimiter;
use CloudCastle\Http\Router\Exceptions\TooManyRequestsException;

$limiter = new RateLimiter(60, 1);
$identifier = $_SERVER['REMOTE_ADDR'];

// –ü—Ä–æ–≤–µ—Ä–∫–∞
if ($limiter->tooManyAttempts($identifier)) {
    $retryAfter = $limiter->availableIn($identifier);
    $remaining = $limiter->remaining($identifier);
    
    $exception = new TooManyRequestsException('Too many requests');
    $exception->setRetryAfter($retryAfter);
    $exception->setRemaining($remaining);
    
    throw $exception;
}

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ø—ã—Ç–∫–∏
$limiter->attempt($identifier);

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
$info = [
    'remaining' => $limiter->remaining($identifier),
    'reset_in' => $limiter->availableIn($identifier),
];
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –†–æ—É—Ç–µ—Ä | –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å | API | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è | –û—Ü–µ–Ω–∫–∞ |
|--------|-----------------|-----|------------|--------|
| **CloudCastle** | ‚úÖ **RateLimiter** | **–ü–æ–ª–Ω—ã–π** | **remaining, availableIn** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** |
| Laravel | ‚úÖ RateLimiter | –ü–æ–ª–Ω—ã–π | remaining, availableIn | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| Symfony | ‚úÖ RateLimiter | –ü–æ–ª–Ω—ã–π | –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| FastRoute | ‚ùå –ù–µ—Ç | - | - | ‚ùå |
| Slim | ‚ùå –ù–µ—Ç | - | - | ‚ùå |

---

## Route Shortcuts

### –û–ø–∏—Å–∞–Ω–∏–µ

–ë—ã—Å—Ç—Ä—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ Rate Limiting.

### throttleStandard()

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ª–∏–º–∏—Ç - 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É:

```php
Route::get('/api/data', $action)
    ->throttleStandard();

// –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç
// ->throttle(60, 1)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û–±—ã—á–Ω—ã–µ API endpoints
- –ü—É–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞

### throttleStrict()

–°—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç - 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É:

```php
Route::post('/api/sensitive', $action)
    ->throttleStrict();

// –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç
// ->throttle(10, 1)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –§–æ—Ä–º—ã (–∫–æ–Ω—Ç–∞–∫—Ç, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–±–æ—á–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏

### throttleGenerous()

–©–µ–¥—Ä—ã–π –ª–∏–º–∏—Ç - 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É:

```php
Route::get('/api/public', $action)
    ->throttleGenerous();

// –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç
// ->throttle(1000, 1)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—É–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ API
- High-traffic endpoints

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| Shortcuts | CloudCastle | Laravel | Symfony | –û—Ü–µ–Ω–∫–∞ |
|-----------|-------------|---------|---------|--------|
| –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ | ‚úÖ 3 —à—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |

**–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** CloudCastle - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å –≥–æ—Ç–æ–≤—ã–º–∏ shortcuts!

**–ü–ª—é—Å—ã:**
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞
- ‚úÖ –°–∞–º–æ–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º—ã–π –∫–æ–¥
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```php
// –Ø—Å–Ω—ã–π –∏ —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥
Route::group(['prefix' => '/api'], function() {
    Route::get('/public/news', $action)->throttleGenerous();
    Route::get('/users', $action)->throttleStandard();
    Route::post('/contact', $action)->throttleStrict();
});
```

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏

### –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

#### CloudCastle HTTP Router

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```php
Route::post('/api/data', $action)
    ->throttle(60, 1);

// –ò–ª–∏
Route::post('/api/data', $action)
    ->throttleStandard();
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Rate Limiting
- ‚úÖ TimeUnit enum
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª—é—á–∏
- ‚úÖ RateLimiter –∫–ª–∞—Å—Å
- ‚úÖ 3 shortcuts
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏–º–∏—Ç–∞—Ö (remaining, availableIn)

**–ü–ª—é—Å—ã:**
- ‚úÖ –ò–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π API
- ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å
- ‚úÖ Shortcuts

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è In-memory storage (–¥–ª—è production –ª—É—á—à–µ Redis)

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

---

#### Laravel

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```php
Route::post('/api/data', $action)
    ->middleware('throttle:60,1');

// –ò–ª–∏ –≤ RouteServiceProvider
RateLimiter::for('api', function (Request $request) {
    return Limit::perMinute(60);
});
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Rate Limiting
- ‚úÖ Named limiters
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã
- ‚úÖ Redis –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚ùå –ù–µ—Ç TimeUnit enum
- ‚ùå –ù–µ—Ç shortcuts

**–ü–ª—é—Å—ã:**
- ‚úÖ –ú–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π
- ‚úÖ Redis –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ Named limiters

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è Middleware syntax –º–µ–Ω–µ–µ —É–¥–æ–±–µ–Ω
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

---

#### Symfony

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```php
// –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
composer require symfony/rate-limiter

// –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
use Symfony\Component\RateLimiter\RateLimiterFactory;

$limiter = $factory->create($identifier);
if (!$limiter->consume()->isAccepted()) {
    throw new TooManyRequestsException();
}
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚ö†Ô∏è –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- ‚úÖ –ú–æ—â–Ω—ã–π RateLimiter
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚úÖ Redis/Memcached

**–ü–ª—é—Å—ã:**
- ‚úÖ –û—á–µ–Ω—å –≥–∏–±–∫–∏–π
- ‚úÖ –†–∞–∑–ª–∏—á–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (Token Bucket, Fixed Window, Sliding Window)

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ –≤—Å—Ç—Ä–æ–µ–Ω –≤ —Ä–æ—É—Ç–µ—Ä
- ‚ùå –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5) - –º–æ—â–Ω—ã–π, –Ω–æ —Å–ª–æ–∂–Ω—ã–π

---

#### FastRoute

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
// –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏
// –ù—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å —Å–≤–æ–π middleware

$rateLimiter = new CustomRateLimiter();
if ($rateLimiter->isLimited($ip)) {
    throw new Exception('Rate limit exceeded');
}
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚ùå –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ü–ª—é—Å—ã:**
- –ù–µ—Ç (–Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å —Å –Ω—É–ª—è)

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚ùå –ù—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å —Å–∞–º–æ–º—É
- ‚ùå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê (1/5) - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

---

#### Slim

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
// –¢—Ä–µ–±—É–µ—Ç middleware –ø–∞–∫–µ—Ç
composer require psr7-sessions/storageless

// Middleware
$app->add(new RateLimitMiddleware($storage, 60, 1));
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚ùå –ù–µ –≤—Å—Ç—Ä–æ–µ–Ω
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –ø–∞–∫–µ—Ç

**–ü–ª—é—Å—ã:**
- ‚ö†Ô∏è –ï—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚ùå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê (2/5) - —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø. –ø–∞–∫–µ—Ç—ã

---

### –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –§–∏—á–∞ | CloudCastle | Laravel | Symfony | FastRoute | Slim |
|------|-------------|---------|---------|-----------|------|
| –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| –ü—Ä–æ—Å—Ç–æ–π API | ‚úÖ | ‚ö†Ô∏è | ‚ùå | - | - |
| TimeUnit enum | ‚úÖ | ‚ùå | ‚ùå | - | - |
| –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª—é—á–∏ | ‚úÖ | ‚úÖ | ‚úÖ | - | - |
| Shortcuts | ‚úÖ | ‚ùå | ‚ùå | - | - |
| –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (remaining) | ‚úÖ | ‚úÖ | ‚úÖ | - | - |
| Redis –ø–æ–¥–¥–µ—Ä–∂–∫–∞ | ‚ö†Ô∏è | ‚úÖ | ‚úÖ | - | - |
| **–û—Ü–µ–Ω–∫–∞** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** | **‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê** | **‚≠ê‚≠ê‚≠ê‚≠ê** | **‚≠ê** | **‚≠ê‚≠ê** |

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ Production

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö endpoints:**
   ```php
   Route::group(['prefix' => '/api'], function() {
       Route::get('/public/*', $action)->throttle(100, 1);
       Route::post('/public/*', $action)->throttle(50, 1);
   });
   ```

2. **–°—Ç—Ä–æ–∂–µ –¥–ª—è write –æ–ø–µ—Ä–∞—Ü–∏–π:**
   ```php
   Route::get('/api/read', $action)->throttle(100, 1);
   Route::post('/api/write', $action)->throttle(20, 1); // –í 5 —Ä–∞–∑ —Å—Ç—Ä–æ–∂–µ
   ```

3. **–û—á–µ–Ω—å —Å—Ç—Ä–æ–≥–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
   ```php
   Route::post('/login', $action)->throttle(5, 1);
   Route::post('/register', $action)->throttle(3, 60);
   Route::post('/password/reset', $action)->throttle(3, 1);
   ```

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö:**
   ```php
   Route::get('/api/user/data', $action)
       ->middleware(['auth'])
       ->throttle(1000, 1, fn($req) => $req->user()->id);
   ```

### Best Practices

**DO:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- ‚úÖ –õ–æ–≥–∏—Ä—É–π—Ç–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ Retry-After header

**DON'T:**
- ‚ùå –ù–µ –¥–µ–ª–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–º–∏ (UX —Å—Ç—Ä–∞–¥–∞–µ—Ç)
- ‚ùå –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ burst traffic
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ª–∏–º–∏—Ç –≤–µ–∑–¥–µ

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```php
// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π
Route::get('/api/data', $action)
    ->throttle(60, 1)
    ->middleware([function($request, $next) {
        try {
            return $next($request);
        } catch (TooManyRequestsException $e) {
            Log::warning('Rate limit exceeded', [
                'ip' => $request->ip(),
                'route' => $request->path(),
            ]);
            throw $e;
        }
    }]);
```

### –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è CloudCastle

–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. **Redis backend:**
   ```php
   $limiter = new RateLimiter(60, 1, new RedisStorage());
   ```

2. **–†–∞–∑–ª–∏—á–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:**
   - Token Bucket
   - Leaky Bucket
   - Sliding Window

3. **Burst –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
   ```php
   ->throttle(60, 1, burst: 10) // 60/min + burst 10
   ```

4. **–ü–æ –≤–µ—Å—É –∑–∞–ø—Ä–æ—Å–æ–≤:**
   ```php
   ->throttleWeighted(['simple' => 1, 'complex' => 5]);
   ```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**CloudCastle HTTP Router –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–Ω—É –∏–∑ –ª—É—á—à–∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π Rate Limiting:**

‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–æ –∏–∑ –∫–æ—Ä–æ–±–∫–∏  
‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π API  
‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏ (TimeUnit enum, shortcuts)  
‚úÖ –ì–∏–±–∫–æ—Å—Ç—å (–∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª—é—á–∏)  
‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (RateLimiter –∫–ª–∞—Å—Å)  

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Ç–ª–∏—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –≥–æ—Ç–æ–≤–∞—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production. –î–ª—è enterprise –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å Redis backend.

---

[‚¨Ü –ù–∞–≤–µ—Ä—Ö](#rate-limiting---–¥–µ—Ç–∞–ª—å–Ω–æ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π) | [üìö –í—Å–µ —Ñ–∏—á–∏](../ALL_FEATURES.md) | [üè† –ì–ª–∞–≤–Ω–∞—è](../../../README.md)

---

¬© 2024 CloudCastle HTTP Router. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
